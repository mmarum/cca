{% extends "base-site.html" %}
{% block title %}Events list{% endblock %}

{% block html_head %}
<style>
/* specific css */
.event_image { width: 100%; }
</style>
{% endblock %}

{% block content %}

{% for event in events %}
  <div class="row top-buffer date_{{ event.edatetime.strftime('%Y-%m-%d') }}" id="eid_{{ event.eid }}">
    <div class="col-sm-4">
      <a href="/app/book/event?eid={{ event.eid }}" class="event_link">
        <img alt="{{ event.image }}" src="/img/small/{{ event.image }}" class="event_image"/>
      </a>
    </div>
    <div class="col-sm-8">
      <span class="date">{{ event.edatetime.strftime('%a %b %d at %I:%M %p')|replace(' 0', ' ') }}</span>
      Duration: {{ event.duration }} hrs
      <a href="/app/book/event?eid={{ event.eid }}" class="event_link">
        <h1>{{ event.title }}</h1>
      </a>
      ${{ event.price }} per person,
      <div><mark><span id="seats_remaining_{{ event.eid }}">{{ event.elimit }}</span> seats remaining.</mark></div>
      <div>Where: {{ event.location }}</div>
      <div><a href="/app/book/event?eid={{ event.eid }}" class="event_link">Book Now</a></div>
      <div>{{ event.description }}</div>
    </div>
  </div>
{% endfor %}

<script>
var orders_count = {{ orders_count }};
for (var key in orders_count) {
  if (orders_count.hasOwnProperty(key)) {
    sr = document.getElementById("seats_remaining_"+key);
    new_value = sr.innerHTML-orders_count[key];
    console.log(key + " -> " + orders_count[key] + " old-val: " + sr.innerHTML + " new-val: " + new_value);
    sr.innerHTML = new_value;
  }
}
if(window.location.hash) {
  var hash = window.location.hash.substr(1);
  alert(hash);
}
</script>
{% endblock %}
